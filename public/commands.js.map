{"version":3,"file":"commands.js","mappings":"YAEA,IAOIA,EAHEC,EAAW,gFACXC,EAAU,+IAKhBC,OAAOC,SAAQ,WACPJ,EAAcG,OAAOE,QAAQC,QAAQC,IACzC,IA+CJJ,OAAOK,QAAQC,UAAU,uBA1CzB,SAA6BC,GAGzBV,EAAYC,SAASU,UACjB,SAAkBC,GACdA,EAAYC,SAAWV,OAAOW,kBAAkBC,WACrCH,EAAYP,QAASO,EAAYI,MA0CpDhB,EAAYC,SAASgB,SAAShB,GAAU,SAACiB,GACjCA,EAAOL,SAAWV,OAAOW,kBAAkBC,UAI/CI,QAAQC,IAAI,gCAADC,OAAiCpB,IAH1CkB,QAAQG,MAAM,8BAADD,OAA+BH,EAAOI,MAAMC,SAI/D,KA9CQJ,QAAQG,MAAM,0BAGtB,IAEAtB,EAAYE,QAAQS,UAAS,SAACO,GACtBA,EAAOL,SAAWV,OAAOW,kBAAkBC,WAK/CI,QAAQC,IAAI,YAADC,OAAaH,EAAOF,QAE/BhB,EAAYE,QAAQe,SAASf,EAAUgB,EAAOF,OAAO,SAACE,GAC9CA,EAAOL,SAAWV,OAAOW,kBAAkBC,UAI/CI,QAAQC,IAAI,+BAADC,OAAgCnB,IAHzCiB,QAAQG,MAAM,8BAADD,OAA+BH,EAAOI,MAAMC,SAI/D,KAZEJ,QAAQG,MAAM,8BAADD,OAA+BH,EAAOI,MAAMC,SAa/D,GAYJ,G","sources":["webpack://onlive-microsoft-addin/./src/commands/commands.js"],"sourcesContent":["// 1. How to construct online meeting details.\n// Not shown: How to get the meeting organizer's ID and other details from your service.\nconst newBody = '<br>' +\n    '<a href=\"https://events-staging.onlive.site/event/71edc0d8-c99e-4b30-8c05-ebd5b5a71248\" target=\"_blank\">Join Onlive.site meeting</a>' +\n    '<br><br>';\n\nconst location = 'https://events-staging.onlive.site/event/71edc0d8-c99e-4b30-8c05-ebd5b5a71248';\nconst subject = '<a href=\"https://onlive.site/\" target=\"_blank\"><img src=\"https://alev-dev.github.io/mic-addin/public/assets/icon-32.png\" alt=\"Onlive\" /></a>';\n\nlet mailboxItem;\n\n// Office is ready.\nOffice.onReady(function () {\n        mailboxItem = Office.context.mailbox.item;\n    }\n);\n\n// 2. How to define and register a function command named `insertOnliveMeeting` (referenced in the manifest)\n//    to update the meeting body with the online meeting details.\nfunction insertOnliveMeeting(event) {\n    // Get HTML body from the client.\n    //Get and update location\n    mailboxItem.location.getAsync(\n        function callback(asyncResult) {\n        if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\n            updateBody(asyncResult.context, asyncResult.value);\n        } else {\n            console.error(\"Failed to get Location.\");\n            return;\n        }\n    });\n    // Get and update subject\n    mailboxItem.subject.getAsync((result) => {\n        if (result.status !== Office.AsyncResultStatus.Succeeded) {\n          console.error(`Action failed with message ${result.error.message}`);\n          return;\n        }\n\n        console.log(`Subject: ${result.value}`);\n\n        mailboxItem.subject.setAsync(subject + result.value, (result) => {\n            if (result.status !== Office.AsyncResultStatus.Succeeded) {\n              console.error(`Action failed with message ${result.error.message}`);\n              return;\n            }\n            console.log(`Successfully set subject to ${subject}`);\n        });        \n    });\n    /*mailboxItem.body.getAsync(\"html\",\n        { asyncContext: event },\n        function (getBodyResult) {\n            if (getBodyResult.status === Office.AsyncResultStatus.Succeeded) {\n                updateBody(getBodyResult.asyncContext, getBodyResult.value);\n            } else {\n                console.error(\"Failed to get HTML body.\");\n                getBodyResult.asyncContext.completed({ allowEvent: false });\n            }\n        }\n    );*/\n}\n// Register the function.\nOffice.actions.associate(\"insertOnliveMeeting\", insertOnliveMeeting);\n\n// 3. How to implement a supporting function `updateBody`\n//    that appends the online meeting details to the current body of the meeting.\nfunction updateBody(event, existingBody) {\n    // Append new body to the existing body.\n    mailboxItem.location.setAsync(location, (result) => {\n        if (result.status !== Office.AsyncResultStatus.Succeeded) {\n          console.error(`Action failed with message ${result.error.message}`);\n          return;\n        }\n        console.log(`Successfully set location to ${location}`);\n    });\n    /*mailboxItem.body.setAsync(existingBody + newBody,\n        { asyncContext: event, coercionType: \"html\" },\n        function (setBodyResult) {\n            if (setBodyResult.status === Office.AsyncResultStatus.Succeeded) {\n                setBodyResult.asyncContext.completed({ allowEvent: true });\n            } else {\n                console.error(\"Failed to set HTML body.\");\n                setBodyResult.asyncContext.completed({ allowEvent: false });\n            }\n        }\n    );*/\n}"],"names":["mailboxItem","location","subject","Office","onReady","context","mailbox","item","actions","associate","event","getAsync","asyncResult","status","AsyncResultStatus","Succeeded","value","setAsync","result","console","log","concat","error","message"],"sourceRoot":""}
